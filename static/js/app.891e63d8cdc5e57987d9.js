webpackJsonp([0],{"3hQz":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("MAQQ"),o={name:"EditableText",props:{content:String,placeholder:String,keyFilter:Function,validation:Function,getParentCommands:Function},data:function(){return{editing:!1,temp_content:""}},methods:{focus:function(){this.$refs.input2.focus()},sel:function(){this.editing=!0,this.temp_content=this.content,this.$nextTick(function(){this.$refs.input.select()})},sel_end:function(){this.is_valid&&(this.editing=!1,this.$emit("update:content",this.temp_content),this.$nextTick(function(){this.$emit("focus")}))},sel_abort:function(){this.editing=!1,this.$nextTick(function(){this.$emit("focus")})},get_commands:function(){return this.editing?[]:this.getParentCommands()},log:function(t){console.log(t)}},computed:{content_size:function(){var t=this.temp_content.length;return t>0?t:this.placeholder.length},content_or_placeholder:function(){return this.content.length?this.content:this.placeholder},is_valid:function(){return!this.validation||this.validation(this.editing?this.temp_content:this.content)}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.editing?n("input",{directives:[{name:"model",rawName:"v-model",value:t.temp_content,expression:"temp_content"}],ref:"input",staticClass:"astnode editing",class:{invalidInput:!this.is_valid},style:{width:t.content_size+"ch"},attrs:{placeholder:t.placeholder},domProps:{value:t.temp_content},on:{blur:function(e){t.editing=!1},keyup:[function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?(e.stopPropagation(),t.sel_end(e)):null},function(e){return"button"in e||!t._k(e.keyCode,"escape",void 0,e.key,void 0)?(e.stopPropagation(),t.sel_abort(e)):null},function(t){t.stopPropagation()}],keydown:[t.log,function(e){if(!("button"in e)&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete"]))return null;e.stopPropagation()}],input:function(e){e.target.composing||(t.temp_content=e.target.value)}}}):n("span",{ref:"input2",staticClass:"astnode viewing",class:{placeholder:0===this.content.length,invalidInput:!this.is_valid},attrs:{tabindex:"-1"},domProps:{textContent:t._s(t.content_or_placeholder)},on:{click:function(e){e.stopPropagation(),t.$emit("focus")},dblclick:function(e){return e.stopPropagation(),t.sel(e)},keyup:[function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?(e.stopPropagation(),t.sel(e)):null},function(e){e.stopPropagation(),t.$emit("keyup",e)}]}})},staticRenderFns:[]};var r=n("VU/8")(o,s,!1,function(t){n("52Ao")},"data-v-4a253f00",null).exports,a={name:"BinOp",mixins:[i.a],components:{EditableText:r},props:{reqPrecedence:Number},methods:{get_children:function(){return[this.$refs.left.get_node(),this.$refs.right.get_node()]},replace_child:function(t,e){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=null===e?{type:"expr"}:e;t===this.$refs.left.get_node()?(this.data.left=n,this.$nextTick(function(){this.$refs.left.get_node().focus()})):t===this.$refs.right.get_node()&&(this.data.right=n,this.$nextTick(function(){this.$refs.right.get_node().focus()}))},get_commands:function(){return this.get_base_commands().concat([["c","edit op",this.edit_op,function(){return!0}],["s","swap operands",this.swap,function(){return!0}]]).concat(this.parent.get_child_commands(this))},get_child_commands:function(t){return[]},edit_op:function(){this.$refs.op.sel()},swap:function(){var t=this.data.left;this.data.left=this.data.right,this.data.right=t},validate_op:function(t){return this.ops.indexOf(t)>=0},update_op:function(t){this.data.op.type=this.op_names[this.ops.indexOf(t)]}},computed:{ops:function(){return["+","-","*","@","/","%","**","<<",">>","|","^","&","//"]},op_names:function(){return["Add","Sub","Mult","MatMult","Div","Mod","Pow","LShift","RShift","BitOr","BitXor","BitAnd","FloorDiv"]},op_prec:function(){return[11,11,12,12,12,12,14,10,10,7,8,9,12]},op_str:function(){switch(this.data.op.type){case"Add":return"+";case"Sub":return"-";case"Mult":return"*";case"MatMult":return"@";case"Div":return"/";case"Mod":return"%";case"Pow":return"**";case"LShift":return"<<";case"RShift":return">>";case"BitOr":return"|";case"BitXor":return"^";case"BitAnd":return"&";case"FloorDiv":return"//"}},precedence:function(){var t=this.op_names.indexOf(this.data.op.type);return t<0?-1:this.op_prec[t]},show_parens:function(){return this.precedence<this.reqPrecedence}}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{ref:"elmt",staticClass:"astnode",attrs:{tabindex:"-1"},on:{keyup:function(e){return e.stopPropagation(),t.onKey(e)},click:function(e){return e.stopPropagation(),t.focus(e)}}},[n("transition",{attrs:{name:"fade"}},[t.show_parens?n("span",{staticClass:"parens"},[t._v("(")]):t._e()]),n("nodecomp",{ref:"left",attrs:{data:t.data.left,parent:t.thisNode,reqPrecedence:t.precedence}}),t._v(" "),n("EditableText",{ref:"op",attrs:{content:t.op_str,placeholder:"<op>",validation:t.validate_op,getParentCommands:t.get_base_commands},on:{"update:content":t.update_op,focus:t.focus,keyup:t.onKey}}),t._v(" "),n("nodecomp",{ref:"right",attrs:{data:t.data.right,parent:t.thisNode,reqPrecedence:t.precedence+1}}),n("transition",{attrs:{name:"fade"}},[t.show_parens?n("span",{staticClass:"parens"},[t._v(")")]):t._e()])],1)},staticRenderFns:[]};var d=n("VU/8")(a,c,!1,function(t){n("Aqzk")},"data-v-6528aaba",null).exports,u={name:"Num",mixins:[i.a],components:{EditableText:r},methods:{get_children:function(){return[]},get_commands:function(){return this.$refs.elmt.get_commands()},get_own_commands:function(){return this.get_base_commands().concat([["Enter","Edit",function(){},function(){return!0}]])},validate:function(t){return t.match(new RegExp("^((([1-9](_?[0-9])*|0(_?0)*)|0b(_?[0-1])+|0o(_?[0-7])+|0x(_?([0-9]|[a-fA-F]))+)|((([0-9](_?[0-9])*)?\\.[0-9](_?[0-9])*|[0-9](_?[0-9])*\\.)|([0-9](_?[0-9])*|(([0-9](_?[0-9])*)?\\.[0-9](_?[0-9])*|[0-9](_?[0-9])*\\.))e[\\+-]?[0-9](_?[0-9])*)|(((([0-9](_?[0-9])*)?\\.[0-9](_?[0-9])*|[0-9](_?[0-9])*\\.)|([0-9](_?[0-9])*|(([0-9](_?[0-9])*)?\\.[0-9](_?[0-9])*|[0-9](_?[0-9])*\\.))e[\\+-]?[0-9](_?[0-9])*)|[0-9](_?[0-9])*)j)$"))}}},l={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("EditableText",{ref:"elmt",attrs:{content:t.data.n,placeholder:"<num>",validation:t.validate,getParentCommands:t.get_own_commands},on:{"update:content":function(e){t.$set(t.data,"n",e)},focus:t.focus,keyup:t.onKey}})},staticRenderFns:[]};var h=n("VU/8")(u,l,!1,function(t){n("Na3P")},"data-v-75b7778f",null).exports,p={name:"stmt",mixins:[i.a],methods:{get_children:function(){return[]},get_commands:function(){var t=this;return this.get_base_commands().concat([["s","Name",function(){t.parent.replace_child(t,{type:"Name",id:""})},function(){return!0}],["n","Num",function(){t.parent.replace_child(t,{type:"Num",n:""})},function(){return!0}]])}},computed:{is_meta_node:function(){return!0}}},f={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{ref:"elmt",staticClass:"astnode invalidInput",attrs:{tabindex:"-1"},on:{keyup:function(e){return e.stopPropagation(),t.onKey(e)},click:function(e){return e.stopPropagation(),t.focus(e)}}},[t._v("<stmt>")])},staticRenderFns:[]};var _=n("VU/8")(p,f,!1,function(t){n("I10W")},"data-v-754d310a",null).exports,m={name:"Name",mixins:[i.a],components:{EditableText:r},methods:{get_children:function(){return[]},get_commands:function(){return this.$refs.elmt.get_commands()},get_own_commands:function(){return this.get_base_commands().concat([["Enter","Edit",function(){},function(){return!0}]])},validate:function(t){return t.match(/^[a-z_][a-z0-9_]*$/i)&&["False","class","finally","is","return","None","continue","for","lambda","try","True","def","from","nonlocal","while","and","del","global","not","with","as","elif","if","or","yield","assert","else","import","pass","break","except","in","raise"].indexOf(t)<0}}},g={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("EditableText",{ref:"elmt",attrs:{content:t.data.id,placeholder:"<name>",validation:t.validate,getParentCommands:t.get_own_commands},on:{"update:content":function(e){t.$set(t.data,"id",e)},focus:t.focus,keyup:t.onKey}})},staticRenderFns:[]};var v={name:"nodecomp",components:{BinOp:d,Num:h,stmt:_,Name:n("VU/8")(m,g,!1,function(t){n("ivbf")},"data-v-c5290356",null).exports},props:{data:Object,parent:Object,reqPrecedence:Number,idx:Number},methods:{get_node:function(){return this.$refs.elmt}},beforeCreate:function(){this.$options.components.expr=n("LU0E").default}},b={render:function(){var t=this.$createElement;return(this._self._c||t)(this.data.type,{ref:"elmt",tag:"component",attrs:{data:this.data,parent:this.parent,reqPrecedence:this.reqPrecedence}})},staticRenderFns:[]};var y=n("VU/8")(v,b,!1,function(t){n("8v1P")},"data-v-d4151d9a",null);e.default=y.exports},"52Ao":function(t,e){},"8v1P":function(t,e){},Aqzk:function(t,e){},I10W:function(t,e){},LU0E:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"expr",mixins:[n("MAQQ").a],methods:{get_children:function(){return[]},get_commands:function(){var t=this;return this.get_base_commands().concat([["s","Name",function(){t.parent.replace_child(t,{type:"Name",id:""})},function(){return!0}],["n","Num",function(){t.parent.replace_child(t,{type:"Num",n:""})},function(){return!0}]])}},computed:{is_meta_node:function(){return!0}}},o={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{ref:"elmt",staticClass:"astnode invalidInput",attrs:{tabindex:"-1"},on:{keyup:function(e){return e.stopPropagation(),t.onKey(e)},click:function(e){return e.stopPropagation(),t.focus(e)}}},[t._v("<expr>")])},staticRenderFns:[]};var s=n("VU/8")(i,o,!1,function(t){n("bHWh")},"data-v-79d69bba",null);e.default=s.exports},MAQQ:function(t,e,n){"use strict";var i=n("olkN");e.a={data:function(){return{store:i.a.store,default_child_idx:0}},props:{data:Object,parent:Object,indent:Number},methods:{focus:function(){this.$refs.elmt.focus(),this.store.selection=this},onKey:function(t){this.get_commands().forEach(function(e){t.key===e[0]&&e[3]()&&(e[2](t),t.stopPropagation())})},get_parents:function(){for(var t=[],e=this;e.parent;)t.push(e.parent),e=e.parent;return t.reverse()},has_parent:function(){return!!this.parent},select_parent:function(t){this.parent?this.parent.focus():console.log("No Parent")},has_child:function(){return this.get_children().length>0},select_child:function(t){this.get_children().length?this.get_children().length>this.data.default_child_idx?this.get_children()[this.data.default_child_idx].focus():(this.data.default_child_idx=0,this.get_children()[0].focus()):console.log("No Child")},has_right_sibling:function(){if(this.parent&&this.parent.get_children().indexOf(this)+1<this.parent.get_children().length)return!0;return!1},select_right_sibling:function(t){if(this.parent){var e=this.parent.get_children().indexOf(this)+1;e<this.parent.get_children().length?(this.parent.get_children()[e].focus(),this.parent.data.default_child_idx=e):console.log("No Right Sibling")}else console.log("No Parent")},has_left_sibling:function(){if(this.parent&&this.parent.get_children().indexOf(this)-1>=0)return!0;return!1},select_left_sibling:function(t){if(this.parent){var e=this.parent.get_children().indexOf(this)-1;e>=0?(this.parent.get_children()[e].focus(),this.parent.data.default_child_idx=e):console.log("No Left Sibling")}else console.log("No Parent")},get_base_commands:function(){return[["ArrowUp","Select parent",this.select_parent,this.has_parent],["ArrowDown","Select child",this.select_child,this.has_child],["ArrowRight","Select right",this.select_right_sibling,this.has_right_sibling],["ArrowLeft","Select left",this.select_left_sibling,this.has_left_sibling],["Delete","delete node",this.delete_this_node,this.is_deletable],["Backspace","delete node",this.delete_bs_this_node,this.is_deletable]]},delete_this_node:function(){this.parent.replace_child(this,null)},delete_bs_this_node:function(){this.parent.replace_child(this,null,!1)},is_deletable:function(){return this.has_parent()&&!this.is_meta_node}},computed:{thisNode:function(){return this},is_meta_node:function(){return!1}},beforeCreate:function(){this.$options.components.nodecomp=n("3hQz").default}}},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),o=n("olkN"),s=n("MAQQ"),r=n("3hQz"),a={name:"Module",mixins:[s.a],components:{nodecomp:r.default},props:{data:Object,avail_width:Number},methods:{get_children:function(){return this.$refs.elmts.sort(function(t,e){return t.idx-e.idx}).map(function(t){return t.get_node()})},replace_child:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.get_children().indexOf(t);if(i<0)console.log("Invalid Child Index!!!");else if(null!==e)this.$set(this.data.body,i,e),this.$nextTick(function(){this.get_children()[i].focus()});else{n?this.data.body.splice(i,1):this.$set(this.data.body,i,{type:"stmt"}),0===this.data.body.length&&this.data.body.push({type:"stmt"});var o=Math.min(this.data.body.length-1,i);this.$nextTick(function(){this.get_children()[o].focus()})}},get_commands:function(){return this.get_base_commands().concat([[",","insert statement after",this.append_child,function(){return!0}],[";","insert statement before",this.insert_child_before,function(){return!0}]])},get_child_commands:function(t){var e=this;return[[";","insert statement before",function(){e.insert_child(t,!1)},function(){return!0}],[",","insert statement after",function(){e.insert_child(t,!0)},function(){return!0}]]},append_child:function(){this.insert_child(null,!0)},insert_child_before:function(){this.insert_child(null,!1)},insert_child:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null===t?e*this.data.body.length:this.get_children().indexOf(t)+e;console.log(t),console.log(n),this.data.body.splice(n,0,{type:"stmt"}),this.$nextTick(function(){this.get_children()[n].focus()})}},computed:{},beforeCreate:function(){this.$options.components.nodecomp=n("3hQz").default}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"elmt",staticClass:"astnode",staticStyle:{"min-height":"80vh"},attrs:{tabindex:"-1"},on:{keyup:function(e){return e.stopPropagation(),t.onKey(e)},keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete"]))return null;e.preventDefault(),e.stopPropagation()},click:function(e){return e.stopPropagation(),t.focus(e)}}},t._l(t.data.body,function(e,i){return n("div",[n("nodecomp",{ref:"elmts",refInFor:!0,attrs:{data:e,parent:t.thisNode,idx:i}})],1)}))},staticRenderFns:[]};var d={name:"app",components:{Module:n("VU/8")(a,c,!1,function(t){n("VuHp")},"data-v-7928f727",null).exports},data:function(){return{store:o.a.store,sidebar_width:300,drag_start:null,avail_width:1e3}},methods:{clear_sel:function(){this.store.selection=null},bindMouseEvents:function(){document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("mousemove",this.handleMouseMove)},removeMouseEvents:function(){document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("mousemove",this.handleMouseMove)},handleMouseDown:function(t){this.drag_start=t.pageX,this.bindMouseEvents()},handleMouseUp:function(t){this.drag_start=null,this.removeMouseEvents()},handleMouseMove:function(t){this.sidebar_width+=-(t.pageX-this.drag_start),this.drag_start=t.pageX,this.$nextTick(this.getWindowWidth)},getWindowWidth:function(){this.avail_width=Math.floor(this.$refs.code.offsetWidth/this.$refs.sizeHint.offsetWidth)}},computed:{sel:function(){return null!==this.store.selection?this.store.selection.data.type:""},sel_parents:function(){return null!==this.store.selection?this.store.selection.get_parents():[]},sel_commands:function(){return null!==this.store.selection?this.store.selection.get_commands():[]}},mounted:function(){window.onclick=this.clear_sel,this.$nextTick(function(){window.addEventListener("resize",this.getWindowWidth),this.getWindowWidth()})},beforeDestroy:function(){window.removeEventListener("resize",this.getWindowWidth)}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{dragging:null!==t.drag_start},attrs:{id:"app"}},[n("span",{ref:"sizeHint",staticStyle:{visibility:"hidden",position:"fixed"}},[t._v("1")]),t._v(" "),n("div",{staticClass:"code"},[n("div",{ref:"code",staticClass:"codecontent"},[n("Module",{attrs:{data:t.store.data,avail_width:t.avail_width}})],1)]),t._v(" "),n("div",{staticClass:"separator",on:{mousedown:function(e){return e.stopPropagation(),t.handleMouseDown(e)}}}),t._v(" "),n("div",{staticClass:"sidebar",style:{width:t.sidebar_width+"px",minWidth:t.sidebar_width+"px"},on:{mousedown:function(t){t.stopPropagation(),t.preventDefault()},click:function(t){t.stopPropagation(),t.preventDefault()}}},[n("div",[t._l(t.sel_parents,function(e){return n("span",{staticStyle:{"font-size":"10pt",cursor:"pointer"},on:{click:function(t){t.stopPropagation(),e.focus()}}},[t._v(t._s(e.data.type)+" -> ")])}),0===t.sel_parents.length&&t.sel.length?n("span",{staticStyle:{"font-size":"10pt",color:"transparent"}},[t._v(" -> ")]):t._e()],2),t._v("\n    "+t._s(t.sel)+"\n    "),t._m(0),t._v(" "),t._l(t.sel_commands,function(e){return n("div",{class:{unavailable:!e[3](),available:e[3]()},staticStyle:{"font-size":"12pt"},on:{click:function(t){t.stopPropagation(),e[3]()&&e[2]()}}},[t._v(t._s(e[0])+": "+t._s(e[1]))])})],2)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("br")])}]};var l=n("VU/8")(d,u,!1,function(t){n("kRpC")},null,null).exports;new i.a({el:"#app",render:function(t){return t(l)}})},Na3P:function(t,e){},VuHp:function(t,e){},bHWh:function(t,e){},ivbf:function(t,e){},kRpC:function(t,e){},olkN:function(t,e,n){"use strict";e.a={store:{selection:null,data:{type:"Module",body:[{type:"BinOp",left:{type:"Name",id:"a",ctx:{type:"Load"}},op:{type:"Add"},right:{type:"Name",id:"b",ctx:{type:"Load"}}},{type:"BinOp",left:{type:"BinOp",left:{type:"Num",n:"1"},op:{type:"FloorDiv"},right:{type:"Num",n:"2"}},op:{type:"Sub"},right:{type:"BinOp",left:{type:"Num",n:"3"},op:{type:"Add"},right:{type:"Num",n:"4"}}}]}}}}},["NHnr"]);
//# sourceMappingURL=app.891e63d8cdc5e57987d9.js.map